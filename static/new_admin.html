<head>
</head>
<body>
    <h1 id="header"></h1>
    <button onclick="refreshData()">Pull data</button>
    <input id="phoneNumberEntry" type="tel" placeholder="phone"/>
    <button onclick="portData()">Port data for phone</button>
    <script defer>
        const initDetails = {
            method: 'get',
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow_Methods": "GET",
                "Access-Control_Allow_Headers": "*",
                "Cache-Control": "no-cache"
            },
            mode: "cors"
        };
        // HTTP helpers
        const get = async (route, queryArgs) => {
            const queryArgsList = [];
            for (const arg in queryArgs) {
                queryArgsList.push(`${arg}=${queryArgs[arg]}`);
            }
            const queryString = queryArgsList.length > 0 ? `?${queryArgsList.join("&")}` : "";
            return await fetch(`${apiURL}/${route}${queryString}`, initDetails);
        }
        const post = async (route, body) => {
            const initDetails = {
                method: 'post',
                headers: {
                    "Access-Control-Allow-Origin": "*",
                    "Access-Control-Allow_Methods": "POST",
                    "Access-Control_Allow_Headers": "*",
                    "Content-Type": "application/json; charset=utf-8",
                    "Cache-Control": "no-cache"
                },
                mode: "cors",
                body: JSON.stringify(body)
            };
            return await fetch(`${apiURL}/${route}`, initDetails);
        }

        var apiURL = "https://coherence-chat.herokuapp.com";
        const refreshData = () => {
            get("admin/everything", {}).then(response => response.json()).then(result => {
                console.log(result);
            });
        }

        const portDataForPhone = () => {
            const phoneNumber = document.getElementById("phoneNumber").value;
            post("admin/portData", { phoneNumber }).then(response => response.json()).then(result => {
                refreshData();
            });
        }
    </script>
</body>